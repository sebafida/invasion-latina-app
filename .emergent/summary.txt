<analysis>**original_problem_statement:**
The user's production application was unstable due to its backend running on a temporary development server. The initial goal was to migrate the backend to Railway and MongoDB Atlas. During this process, the user requested over 14 new features and bug fixes, which were implemented but remain largely untested.

After migrating to Railway/MongoDB, the user continued to experience intermittent connection issues, which they attribute to the sleep mode of MongoDB Atlas's free/low-cost tiers. Frustrated with this perceived instability and the cost, the user has decided to pivot and migrate the entire backend from MongoDB to **Supabase (PostgreSQL)**.

The user has also requested to **completely remove the complex and buggy Face ID logic** in favor of a simpler stay logged in session management.

**PRODUCT REQUIREMENTS (Current Focus):**
1.  **[P0]** Migrate the entire backend from MongoDB/Pymongo to Supabase/PostgreSQL using the  library.
2.  **[P0]** Remove all Face ID and biometric-related logic from the frontend, ensuring a simple login flow: log in once, stay logged in until explicit logout.
3.  **[P1]** After migration, verify and test the recently added QR Code features:
    *   A user-side scanner in the profile page to claim Invasion Coins.
    *   An admin-side management panel to generate, activate, and deactivate event-specific QR codes.
4.  **[P1]** After migration, test and verify the admin panel feature that lists all registered users.
5.  **[P2]** Implement push notifications for:
    *   A reminder 24 hours before an event.
    *   When a DJ accepts/rejects a song request.

**User's preferred language**: French. The next agent MUST respond in French.

**what currently exists?**
The application consists of a React Native/Expo frontend and a FastAPI backend. The backend is deployed on Railway, but it's currently connected to a MongoDB Atlas database that the user wants to decommission. The user has provided the project URL and anon key for a new Supabase project. The agent has analyzed the existing MongoDB collections and has a clear plan for the new PostgreSQL schema on Supabase. A significant number of features (geofencing, Cloudinary uploads, new admin panels) have been coded but are unverified and will need to be adapted to the new Supabase backend.

**Last working item**:
- Last item agent was working: The agent was at the very beginning of the **MongoDB to Supabase migration**. After analyzing the existing MongoDB collections in , the agent received the Supabase credentials from the user and was about to start creating the SQL schema and refactoring the backend code.
- Status: **NOT STARTED** (The actual code migration has not begun).
- Agent Testing Done: N
- Which testing method agent to use? After the migration, use the backend testing agent to verify all endpoints, followed by the frontend testing agent to ensure the app is fully functional.
- User Testing Done: N

**All Pending/In progress Issue list**:
- Issue 1: Perceived Backend Instability (P0)
- Issue 2: Massive Batch of Unverified Features (P1)
- Issue 3: Non-blocking  Version Warning (P2)

**Issues Detail**:
- **Issue 1: Perceived Backend Instability**
    - **Attempted fixes**: Migrated from a dev server to Railway/MongoDB. User upgraded their Railway plan. The user is still experiencing what they believe are sleep mode issues with MongoDB Atlas. The agreed-upon fix is to migrate to Supabase.
    - **Next debug checklist**:
        1.  Execute the migration to Supabase (see Task 1 below).
        2.  Deploy the updated backend to Railway.
        3.  Guide the user to test connectivity thoroughly via a new TestFlight build.
    - **Why fix this issue and what will be achieved with the fix?**: This is the user's main point of frustration. Migrating to Supabase aims to provide a stable, always-on backend, resolve connection problems, and reduce costs for the user.
    - **Status**: NOT STARTED (The fix is the migration task).
    - **Is recurring issue?**: Y
    - **Should Test frontend/backend/both after fix?**: Both.
    - **Blocked on other issue**: None. This is the top priority.

- **Issue 2: Massive Batch of Unverified Features**
    - **Attempted fixes**: Code for 14+ features was written, including a complex Face ID system that has since been removed. A user-side QR scanner and admin management panel were also added.
    - **Next debug checklist**: After the Supabase migration, all these features' data logic must be rewritten. Then, they must be systematically tested end-to-end with the user.
    - **Why fix this issue and what will be achieved with the fix?**: To deliver the large volume of functionality the user has requested over the last few sessions.
    - **Status**: BLOCKED
    - **Is recurring issue?**: N
    - **Should Test frontend/backend/both after fix?**: Both.
    - **Blocked on other issue**: Issue 1 / Task 1 (Supabase Migration).

- **Issue 3: Non-blocking  Version Warning**
    - **Attempted fixes**: None. The issue was identified in the Railway logs ().
    - **Next debug checklist**: In , change the  version to  to match the version expected by .
    - **Why fix this issue and what will be achieved with the fix?**: To clean up production logs and avoid potential future authentication-related bugs.
    - **Status**: NOT STARTED
    - **Is recurring issue?**: Y
    - **Should Test frontend/backend/both after fix?**: Backend (verify logs are clean after fix).
    - **Blocked on other issue**: None.

**In progress Task List**:
- **Task 1: Migrate Backend from MongoDB to Supabase (PostgreSQL) (P0)**
    - **Where to resume**: The user has provided the Supabase URL and anon key. The next steps are:
        1.  Call  for .
        2.  Create a SQL script () to define all the necessary tables in Supabase based on the previous analysis of MongoDB collections.
        3.  Execute this script against the user's Supabase project.
        4.  Refactor  entirely, replacing all  calls with  equivalents for CRUD operations.
        5.  Update  to add  and remove .
        6.  Update environment variables on Railway for the new Supabase credentials.
    - **What will be achieved with this?**: The application's backend will be fully migrated to a new database technology, addressing the user's primary concern about stability and cost.
    - **Status**: IN PROGRESS
    - **Should Test frontend/backend/both after fix?**: Both.
    - **Blocked on something**: Nothing.

**Upcoming and Future Tasks**
- **Upcoming Tasks**:
    - **P1: Full Feature Regression Testing:** Once the Supabase migration is complete, guide the user to test every single feature of the app on a new TestFlight build to find and fix any bugs introduced by the migration.
    - **P2: Implement New Push Notifications:** Develop the backend logic (triggers) and frontend handling for sending push notifications for event reminders and song request status changes.
- **Future Tasks**:
    - Generate and submit an Android Beta Build for the Google Play Store.

**Completed work in this session**
- **Production Backend Deployment & Debugging**: Successfully migrated the backend from a development server to Railway + MongoDB Atlas, resolving multiple deployment failures related to dependencies (, ) and runtime configurations (port mapping).
- **Face ID Feature Removal**: After multiple failed attempts to fix a buggy and confusing Face ID implementation, the feature was completely removed from  and  at the user's request, simplifying the login flow to a persistent session.
- **QR Code System Rework**:
    - Removed the old admin-facing scanner functionality.
    - Implemented a new user-facing QR code scanner page () accessible from the profile.
    - Added backend endpoints (, ) to allow admins to manage event-specific QR codes and users to scan them.
    - Created a new admin management page () to provide a UI for this system.
- **Admin User List Feature**: Implemented a backend endpoint () and a frontend page () to allow administrators to view a list of all registered users.
- **UI/Text Updates**: Corrected and standardized a welcome message across four languages as per the user's specific request.
- **Build Process Guidance**: Repeatedly guided the user through their local iOS build and submission process, debugging issues with usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]
           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]
           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]
           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]
           [--super-prefix=<path>] [--config-env=<name>=<envvar>]
           <command> [<args>]

These are common Git commands used in various situations:

start a working area (see also: git help tutorial)
   clone     Clone a repository into a new directory
   init      Create an empty Git repository or reinitialize an existing one

work on the current change (see also: git help everyday)
   add       Add file contents to the index
   mv        Move or rename a file, a directory, or a symlink
   restore   Restore working tree files
   rm        Remove files from the working tree and from the index

examine the history and state (see also: git help revisions)
   bisect    Use binary search to find the commit that introduced a bug
   diff      Show changes between commits, commit and working tree, etc
   grep      Print lines matching a pattern
   log       Show commit logs
   show      Show various types of objects
   status    Show the working tree status

grow, mark and tweak your common history
   branch    List, create, or delete branches
   commit    Record changes to the repository
   merge     Join two or more development histories together
   rebase    Reapply commits on top of another base tip
   reset     Reset current HEAD to the specified state
   switch    Switch branches
   tag       Create, list, delete or verify a tag object signed with GPG

collaborate (see also: git help workflows)
   fetch     Download objects and refs from another repository
   pull      Fetch from and integrate with another repository or a local branch
   push      Update remote refs along with associated objects

'git help -a' and 'git help -g' list available subcommands and some
concept guides. See 'git help <command>' or 'git help <concept>'
to read about a specific subcommand or concept.
See 'git help git' for an overview of the system., build numbers, version numbers, and  files.

**Known issue recurrence from previous fork**
- None.

**Code Architecture**


**Key Technical Concepts**
-   **Database Migration (In Progress)**: Major architectural shift from NoSQL (MongoDB) to relational SQL (PostgreSQL via Supabase).
-   **Expo EAS Build/Submit Workflow**: The established local process the user follows to create and deploy new iOS builds to TestFlight.
-   **State Management**: Previous complex state logic in  for Face ID proved problematic and was simplified to a basic  state.

**key DB schema**
The agent has analyzed the MongoDB structure and planned the following PostgreSQL tables for Supabase. This schema needs to be created.
-   
-   
-   
-   
-   
-   
-   
-   
-   
-   
-    (new)

**changes in tech stack**
-   **FROM**: FastAPI + **MongoDB**
-   **TO (In Progress)**: FastAPI + **Supabase (PostgreSQL)**

**All files of reference**
-    (The file to be completely refactored for Supabase).
-    (Contains the simplified authentication logic).
-    (The root navigator, now simplified).
-    (New admin feature UI).
-    (New user feature UI).

**Critical Info for New Agent**
-   **The absolute top priority is the Supabase migration.** The user is blocked and waiting for this. Do not work on any other feature or bug until the backend is running on Supabase. Use the credentials the user provided.
-   The user has explicitly decided to **abandon Face ID**. The goal is a simple login system: log in once and stay logged in until the user explicitly logs out from their profile. Ensure the final implementation reflects this.
-   After the migration, a full regression test of all features is **mandatory**. Many features are untested. You must guide the user through testing the QR code scanner, the admin panels, and other core functionalities on a new TestFlight build.
-   You will need to guide the user through their local build process on their Mac (, yarn install v1.22.22
[1/4] Resolving packages...
[2/4] Fetching packages...
[3/4] Linking dependencies...
[4/4] Building fresh packages...
success Saved lockfile.
Done in 4.44s., An Expo user account is required to proceed.

Log in to EAS with email or username (exit and run eas login --help to see other login options)
Input is required, but stdin is not readable. Failed to display prompt: Email or username, An Expo user account is required to proceed.

Log in to EAS with email or username (exit and run eas login --help to see other login options)
Input is required, but stdin is not readable. Failed to display prompt: Email or username). Be prepared to debug issues related to build numbers, version numbers, and lockfiles.

**documents and test reports created in this job**
- None.

**Last 10 User Messages and any pending HUMAN messages**
1.  **User**: Confirms Supabase is the way to go because it has no sleep mode. **Status: Addressed.**
2.  **User**: Asks agent to start the necessary work to put the code on Supabase. **Status: IN PROGRESS.**
3.  **User**: Provides Supabase project URL and anon key. **Status: Addressed.**
4.  **User**: Asks if taking a paid MongoDB plan is a good temporary solution. **Status: Addressed, user chose to proceed with Supabase.**
5.  **User**: Asks if they can migrate to Supabase while Apple is reviewing the current app version. **Status: Addressed, confirmed it's possible as it's a backend change.**
6.  **User**: Confirms the cost savings and testing plan (Expo Go then TestFlight) for the Supabase migration. **Status: Addressed.**
7.  **User**: Confirms that changing the backend does not require re-submission to Apple. **Status: Addressed.**
8.  **User**: Reports that the app on TestFlight is still having connection issues and showing old data (flyer), suspecting the backend is sleeping. **Status: This is the core issue driving the Supabase migration.**
9.  **User**: Asks for the list of all new features implemented since the last App Store approval. **Status: Addressed.**
10. **User**: Reports that the QR Code Management section is missing from the admin profile in the latest TestFlight build (build 29). **Status: Diagnosed as the build not containing the latest code from GitHub.**

**Project Health Check:**
-   **Broken**: The entire application is in a transitional state. The backend data layer is about to be completely replaced. No new features can be worked on until the Supabase migration is complete and stable.
-   **Mocked**: Stripe service remains mocked.

**3rd Party Integrations**
-   **Railway** (Backend Hosting)
-   **MongoDB Atlas** (Database - **BEING REPLACED**)
-   **Supabase** (Database - **NEW, IN PROGRESS**)
-   Cloudinary (Image Management)
-   Expo Application Services (EAS)
-   Apple & Google Sign-In

**Testing status**
-   Testing agent used after significant changes: NO
-   Troubleshoot agent used after agent stuck in loop: NO
-   Test files created: None
-   Known regressions: The user is experiencing intermittent connectivity and stale data on TestFlight, which is the primary driver for the current migration task.

**Credentials to test flow:**
-   **Admin Email**:  / 
-   **Admin Password**: 
-   **Supabase Project URL**: 
-   **Supabase Anon public key**: 

**What agent forgot to execute**
- The  warning in the backend logs was identified but has not been fixed yet. This is a low-priority task to be done after the main migration.
- The agent was in the process of starting the Supabase migration when the session ended. The immediate next step is to execute the plan laid out in In progress Task List.</analysis>
